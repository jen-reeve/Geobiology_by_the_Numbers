# Class notes
## Jan 16 2019
using [Tellurium](tellurium.analogmachine.org) which is built for biological networks (aka metabolic networks)

If you want get Systems Biology: Introduction to Pathway Modeling (on the [analogmachine website](http://books.analogmachine.org/))

Boz wants to be able to go to sites like [Biomodels](https://www.ebi.ac.uk/biomodels/) (where can browse 10k models) and mess around. Tellurium makes it very easy to import models from Biomodels.

Today let's install and play with some simple models.

Boz's goals for the class:
* get familiar with kinetic modeling platform
* use to reproduce some figures from paper from Halevy and Wing 2014 (sulfate reduction modeling)
* to use platform to calculate isotopic fraction in networks
* to enter a proposed early network and then test it
* another early metabolic network model

### concentration of a single molecule in an E. coli cell
Guess radius to be 1um, so the volume (assuming a cube) is 1um^3. There are 1000L in 1m^3 and 1mL is 1cm3. The volume of the cell in L is 1x10^(-15)L

1 molecule is 1x10^(-24)moles

So the concentration of 1 molecule in an E. coli cell is 1x10^(-9)M aka 1nM so this is the lowest possible concentration of a metabolite/substance of interest in a cell. And while we are in the nM range we can't have halves.

The total concentration of stuff in an E. coli cell is ~100mM.

For the future, use [Bionumbers](https://bionumbers.hms.harvard.edu/search.aspx) or [Cell Biology by the Numbers](book.bionumbers.org)

### Running code?!
Successfully ran the simple and slightly more complex examples in the Tellurium Notebook interface

We also tested defining models using the usage example method of defining the model. This also introduces the ability to define compartments.

Book for Earth system model: Mathematical modeling of Earth's Dynamic Systems

For next week, think about explicit examples that you would like to reproduce using this platform (id papers or models). If you have time play with it a little bit. Come in with one new thing that you have discovered. And buy the Systems Bio book!

## Jan 23 2019
Things to not do: biochemistry

Try to find pathways where the steps are known and the kinetics are constrained.

Maybe present models as final SuperLab meeting.

Build a simple graphical representation of the model we want to tackle. We don't want to create new biology, want to take a conceptual model from the literature and build a Tellurium/Antimony model of it.

Looking at the Log Plotting (Calzone) example notebook.

What do the compartment units mean? Probably volume units to change the concentration values into total units.

Often good to start at the end of your metabolic network as the final steps are often considered to be irreversible. A useful fiction.

Quick derivation of this type of transformation that is enzymatically catalyzed (from Noor et. al. 2013 paper):

"Quantum" (unit) process of biochemistry can be represented graphically: Substrate + Enzyme <=> Enzyme-Substrate (Complex)=> Product + Enzyme

This is Michaelis-Menten model (but we will call it the Menten model because she deserves all the credit).

Three kinetic parameters for the model: k_(+1) (forward direction of first step), k_(-1) (reverse direction of the first step), k_(+2) (forward direction of the second step).

We know from elementary chemical theory that the rate of this reaction is equal to the rate of accumulation of the product.

dP/dt = V(S) (where V(S) is the reaction velocity which is dependent on the concentration of the substrate)

This doesn't depend on the concentration of the product, but definitely depends on the concentration of substrate

V(S) = k_(+2) * C (the complex)

Menten assumed that the concentration of the substrate was much much greater than the concentration of the enzyme. so: d(ES)/dt = dC/dt = 0

You end up with a pair of rate laws that reflect these transformations.

1. (k_(+2)+k_(-1)) C = k_(+1) S * E (consumption of the enzyme-substrate complex is equal to the production of the enzyme-substrate complex).

   These rate constants have different units. Consumption has units per time. Production has units of per time*something

2. E_(total) = E + C

   The total enzyme present is equal to the free enzyme times the amount bound up in a complex

E = E_(total) - C

\[
(k_(+2)+k_(-1)) C + k_(+1) S * C = k_(+1) E_(total) * S
\]

$$C = (k_(+1) E_(total) * S) / ((k_(+2)+k_(-1)) + k_(+1) * S) = (E_(total) * S) / ((k_(+2) + k_(-1))/k_(+1) + S)$$

Endmember 1: If the concentration of the substrate is much much bigger than the kinetic ratio (k_(+2)+k_(-1))/k_(+1) then V = k_(+2) * E_(total) which defines V_(max) = k_(cat) * E_(total)

Endmember 2: if the concentration of the substrate is equal to the kinetic ratio (see above) then V = (k_(+2) * E_(total) * S) / (2 * S) = (k_(+2) * E_(total)) / 2 = V_(max) / 2

Now getting back to our lactose model:

Use [Brenda](https://www.brenda-enzymes.org/) to get the enzyme kinetic information.

## Feb 6 2019
Set up:

Diffusion across the membrane: 0 = area * permeability * (S1-S2)

Consumption of the internal substance, with a silent 3rd substance implied: 0 = (Vmax * S2)/(km + S2)

Steady state: dS/dt = 0

At equilibrium all of the net rates are 0, at steady state all the net rates are constant and all the same.

What here defines our net rate? S1 is constant, we start with no S2 and no S3. Once we start we begin to accumulate S2 and S3 and after a while the rate of accumulation of S3 is linear. This linear accumulation rate is the net rate of the system.

You can't have a steady state without the system having "openness" b/c you are accumulating your final product constantly. Defining your first substrate as constant implies/forces an open system. This is a nuance we should consider.

Perhaps clearer to initially define our equations as:

J_ss = area * permeability * (S1 - S2)

J_ss = (Vmax * S2)/(km + S2)

Final form for quadratic: 0 = A*P*S2^2 + S2 * (Km*A*P - A*P*S1 + Vmax) - Km*A*P*S1

a = A*P

b = km*A*P - A*P*S1 + Vmax

c = -km*A*P*S1

### Units

S1/S2 has units of mass/length^3

km has units of mass/length^3

Area has units of length^2

permeability has units of length/time

so Vmax has units of mass/time

Remember that we determined that Vmax = kcat * Etotal

kcat had units of turnover time aka 1/time but really it was mass of substrate/(mass of enzyme * time)

So Vmax has units of mass substrate per time per length^3

So now we have incorporated our volume into the Vmax term, this is the total Vmax, aka on a per cell basis. So to compare these two Vmax terms (the Vmax per enzyme and the Vmax per cell): Vmax_cell = constant * Vmax_enyzme where the constant must have units of length^3 so it must be the volume of the cell.

Vmax_cell is essentially the amount of reactions in the cell

Use our minimum and maximum concentrations in cells as a way to detect units problems.

Our concentrations are given in mass per length cubed given as molarity which is moles per liter. This means that the length unit we are using is the cube root of a liter. Which is (10^3 cm^3)^(1/3) or 10 cm or 1 dm.

We have taken our cell, called it a sphere and then unfurled it and put walls at each end of the membrane so that we can consider things in terms of the surface area. This implies that there is not differential spatial distribution of things in the cells.

For next class:

1. take your antimony code and compare it at steady state to the values you just got. Going to need to know some commands about steady state values (already in code stolen from Boz).
2. explore how the steady state values relate to the external lactose concentration. Make plots of internal vs. external lactose concentration and use the python code.

### Calculations
Calculating what we expect the steady state concentration of S3 (intracellular lactose) to be:
```
import math
import numpy as np
import tellurium as te
# this is our calculation to check our numerical calculations
# 1 liter = 1 dm^3
area = 1.0e-10; # dm^2
permeability = 1.0e-8; # dm s-1
km = 5.5e-3; # M
S1 = 1; # M
kcat = 6.42e2; # s-1
etot = 1.0e-6; # M
vol_cell = 10e-15; # L or dm^3
a = area * permeability;
b = km*area*permeability-area*permeability*S1+kcat*etot*vol_cell;
c = -1*km*area*permeability*S1;
S3_ss=(-b+(b**2-4*a*c)**0.5)/(2*a);
print(a,b,c)
print('S3_ss',S3_ss)
```
Gives 86uM which is nicely in between our limits of physiological concentrations.

Checking that a steady state concentration gives net rates that are equivalent for our two J_ss equations:
```
J_ss1=area*permeability*(S1-S3_ss);
print('J_ss1',J_ss1)
J_ss2=(kcat*etot*vol_cell*S3_ss)/(km+S3_ss);
print('J_ss2',J_ss2)
```
Woo these give the same number. 10^-21 moles per second (per cell) which converts to 10^-16 moles per day (per cell) aka one femtomole per day (per cell) we will call this unit a Jorgensen aka a Jorg. This is a reality check, we put in numbers out of nowhere and got a number that was hard to understand, so we can convert into Jorgs and that is a reasonable process rate for cells in the environment. In culture these rates will always be faster.

Model:
```
model LacPath
    compartment cytoplasm;
    cytoplasm = 1.0;
    compartment environment;
    environment = 1000.0;
    species lactose, glucgalac;
    const species ex_lactose;
    unit M = mole / liter
    unit inv_sec = 1. / seconds
    unit um = 10.e-6 meters
    unit vol_conv = 1000 liter/1 meter^3

    lactose = 0.0 M; # M; free parameter
    glucgalac = 0.0 M;
    ex_lactose = 0.1 M;

    lactose in cytoplasm; glucgalac in cytoplasm;
    ex_lactose in environment

    J34: lactose -> glucgalac; kcat*Etot*lactose/(Km+lactose);

    kcat = 6.42e2 inv_sec; #s^-1; from Juers et al (2012)
    Etot = 1.e-6 M; # M; free parameter
    Km = 5.5e-3 M; # M; from BRENDA

    #J13: ex_lactose => lactose; area*permeability*(ex_lactose-lactose)*conversion;
    #J31: lactose => ex_lactose; area*permeability*(lactose-ex_lactose)*conversion;

    area = 5 um^2;
    permeability = 3 um * 1 inv_sec;
    conversion = 1 vol_conv;
end
```

Running the model
```
LacPath.reset()
LacPath.simulate(0., 100., 1000) #'S1','J1'
LacPath.plot()

values = LacPath.getSteadyStateValues()
selections = LacPath.steadyStateSelections
print(values)
print(selections)
```

## Homework from Feb 5 2019
```
import math
import numpy as np
import matplotlib.pyplot as plt
import tellurium as te
# this is our calculation to check our numerical calculations
# 1 liter = 1 dm^3
area = 1.0e-10; # dm^2
permeability = 1.0e-8; # dm s-1
km = 5.5e-3; # M
S1 = np.linspace(0.1,10,100); # M
kcat = 6.42e2; # s-1
etot = 1.0e-6; # M
vol_cell = 10e-15; # L or dm^3
a = area * permeability;
b = km*area*permeability-area*permeability*S1+kcat*etot*vol_cell;
c = -1*km*area*permeability*S1;
S3_ss=(-b+(b**2-4*a*c)**0.5)/(2*a);
#print(a,b,c)
#print('S3_ss',S3_ss)
plt(S1,S3_ss)


```
